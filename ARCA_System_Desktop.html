<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Gaming Brand & Category Selector</title>
<style>
  body {
    font-family: 'Trebuchet MS';
    margin: 0;
    padding: 20px;
    min-height: 100vh;
    background: linear-gradient(to bottom, #000000, #350000);
    color: rgb(248, 247, 247);
    box-sizing: border-box;
    opacity: 0;
    transform: translateX(-50px);
    animation: fadeInFromLeft 1s ease-out forwards;
  }
  
  @keyframes fadeInFromLeft {
    0% {
      opacity: 0;
      transform: translateX(-50px);
    }
    100% {
      opacity: 1;
      transform: translateX(0);
    }
  }
  
  /* Update the main container */
#main-container {
  display: flex;
  gap: 30px;
  max-width: 1400px;
  margin: 0 auto;
  align-items: flex-start; /* Ensure panels align at the top */
}

/* Fix the selection panel height */
#selection-panel {
  flex: 0 0 400px;
  background: rgba(26, 26, 26, 0.8);
  padding: 25px;
  border-radius: 12px;
  border: 1px solid #c01a1a;
  height: fit-content; /* Adjust to content but don't grow */
  min-height: 650px; /* Set a minimum height */
  position: sticky;
  top: 20px; /* Keep it visible when scrolling */
}

/* Fix the header container */
#header-container {
  transition: all 0.5s ease;
  height: fit-content; /* Don't grow dynamically */
}

/* Ensure titles container has fixed height behavior */
#titles {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: fit-content;
}

/* Fix results panel */
#results-panel {
  flex: 1;
  min-height: 600px;
  height: auto; /* Let it grow with content */
}

/* Update the display container */
#display {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: flex-start;
  align-items: flex-start;
  min-height: 400px;
  height: auto;
}

/* Ensure brand and category lists have consistent height */
#brand-options, #category-options {
  list-style: none;
  padding: 0;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 25px;
  height: fit-content; /* Don't grow with content */
}

/* Update responsive design */
@media (max-width: 1024px) {
  #main-container {
    flex-direction: column;
    gap: 20px;
  }
  
  #selection-panel {
    flex: none;
    width: 100%;
    position: static; /* Remove sticky on mobile */
    min-height: auto; /* Allow natural height on mobile */
  }
}

/* Remove any dynamic height calculations */
.image-container {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  padding: 20px;
  justify-content: flex-start;
  min-height: 400px; /* Ensure minimum height */
}

  h1, h2, h3 {
    margin-top: 1px;
  }

  h1 {
    color: #ff4444;
    text-shadow: 0 0 10px rgba(255, 68, 68, 0.6);
    margin-bottom: 5px;
  }

  h2 {
    color: #ff6b6b;
    margin-bottom: 20px;
  }

  h3 {
    color: #ff8a8a;
    margin-bottom: 10px;
  }

  #sort-container {
    display: none;
    flex-direction: column;
    align-items: flex-start;
    margin-top: 20px;
    width: 100%;
  }

  /* Style for sort dropdown */
#sort-select {
  background-color: #1a1a1a;
  color: white;
  border: 1px solid #c01a1a;
  border-radius: 4px;
  padding: 8px 12px;
  font-family: 'Trebuchet MS';
  font-size: 14px;
  cursor: pointer;
  width: 180px;
  margin-top: 5px;
}

/* Style for wireless filter dropdown */
#wireless-filter {
  background-color: #1a1a1a;
  color: white;
  border: 1px solid #c01a1a;
  border-radius: 4px;
  padding: 8px 12px;
  font-family: 'Trebuchet MS';
  font-size: 14px;
  cursor: pointer;
}

/* Hover state for dropdowns */
#sort-select:hover,
#wireless-filter:hover {
  background-color: #2a2a2a;
  border-color: #ff4444;
}

/* Focus state for dropdowns */
#sort-select:focus,
#wireless-filter:focus {
  outline: none;
  border-color: #ff4444;
  box-shadow: 0 0 5px rgba(192, 26, 26, 0.5);
}

/* Style for dropdown options */
#sort-select option,
#wireless-filter option {
  background-color: #1a1a1a;
  color: white;
  padding: 8px;
}

/* Remove default dropdown arrow and add custom styling (optional) */
#sort-select,
#wireless-filter {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20256%20256%22%3E%3Cpath%20fill%3D%22%23c01a1a%22%20d%3D%22M225.813%2C48.907%2C128%2C146.72%2C30.187%2C48.907%2C0%2C79.093l22.4%2C22.4L128%2C191.093l102.4-102.4L252.8%2C68.28Z%22%2F%3E%3C%2Fsvg%3E");
  background-repeat: no-repeat;
  background-position: right 8px center;
  background-size: 12px;
}

  #brand-options, #category-options {
    list-style: none;
    padding: 0;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 25px;
  }
  
  li {
    padding: 12px 18px;
    background-color: #020000;
    color: rgb(247, 244, 244);
    cursor: pointer;
    border-radius: 6px;
    transition: all 0.3s ease;
    flex: 1 1 auto;
    min-width: 90px;
    text-align: center;
    font-size: 14px;
    border: 2px solid transparent;
  }
  
  li:hover {
    background-color: #15171a;
    transform: translateY(-2px);
  }
  
  li.selected {
    background-color: #c01a1a;
    border: 2px solid #ff4444;
    box-shadow: 0 0 15px rgba(192, 26, 26, 0.4);
  }

  li.selected:hover {
    background-color: #d02b2b;
    transform: translateY(-2px);
  }

  @media (max-width: 1024px) {
    #main-container {
      flex-direction: column;
      gap: 20px;
    }
    
    #selection-panel {
      flex: none;
      width: 100%;
    }
  }

  @media (max-width: 768px) {
    #header-top {
      flex-direction: column;
    }
    #sort-container {
      align-items: flex-start;
      margin-top: 20px;
    }
    
    .image-item {
      flex: 1 1 calc(50% - 20px);
      max-width: calc(50% - 20px);
    }
    
    #brand-options, #category-options {
      flex-direction: column;
    }
    
    li {
      min-width: 100%;
    }
  }

  @media (max-width: 480px) {
    .image-item {
      flex: 1 1 100%;
      max-width: 100%;
    }
    
    body {
      padding: 15px;
    }
  }

  #display {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: flex-start;
    align-items: flex-start;
  }

  .image-item {
    flex: 0 0 calc(33.333% - 20px);
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: transform 0.3s ease;
  }

  .image-item:hover {
    transform: translateY(-5px);
  }

  .image-item img {
    width: 100%;
    max-width: 200px;
    height: 200px;
    object-fit: cover;
    border: 1px solid #c01a1a;
    border-radius: 8px;
  }

  .label {
    font-family: 'Segoe UI';
    font-weight: bolder;
    font-size: 15px;
    margin-top: 5px;
    text-align: center;
  }

  /* Styles for dropdown container */
  #filter-dropdown {
    display: none;
    margin-top: 15px;
    width: 100%;
  }
  
  .reset-btn {
    background-color: #c01a1a;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 6px;
    cursor: pointer;
    font-family: 'Trebuchet MS';
    font-size: 14px;
    margin-top: 15px;
    transition: all 0.3s ease;
    width: 100%;
  }
  
  .reset-btn:hover {
    background-color: #d02b2b;
    transform: translateY(-2px);
  }
  
  .loading {
    text-align: center;
    font-style: italic;
    color: #ccc;
    padding: 500px;
    margin-top: -30%;
  }

  .label {
    font-family: 'Segoe UI';
    font-weight: bolder;
    font-size: 15px;
    margin-top: 5px;
    text-align: center;
    color: #ff4444;
    text-shadow: 0 0 8px rgba(255, 68, 68, 0.4);
    transition: all 0.3s ease;
}

.image-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 20px;
    padding: 20px;
    justify-items: center;
}

.image-item {
    width: 220px; /* Fixed width for all items */
    text-align: center;
}

.image-item img {
    width: 200px;
    height: 200px;
    object-fit: cover;
    border-radius: 8px;
}

/* Product name styling */
.image-item .label:first-of-type {
    color: #ee2727;
    font-size: 16px;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    text-shadow: 0 0 10px rgba(255, 0, 0, 0.6);
    margin-top: 8px;
}

/* Price text styling */
.image-item .label:nth-of-type(2) {
    color: #ff6b6b;
    font-weight: 800;
    text-shadow: 0 0 6px rgba(255, 107, 107, 0.4);
    font-size: 14px;
}

/* Type text styling */
.image-item .label:nth-of-type(3) {
    color: #f03b3b;
    font-weight: 700;
    text-shadow: 0 0 5px rgba(255, 51, 51, 0.4);
    font-size: 13px;
    font-style: italic;
}

/* Hover effects on product items */
.image-item:hover .label:first-of-type {
    color: #e6e3e3;
    text-shadow: 0 0 15px rgba(255, 26, 26, 0.8);
    transform: scale(1.05);
}

/* Glow effect for selected items */
.image-item:hover {
    position: relative;
}

.image-item:hover::before {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    background: radial-gradient(circle, rgba(255,0,0,0.2) 0%, transparent 70%);
    z-index: -1;
    border-radius: 12px;
}

/* Filter section styling */
.filter-section {
  margin-top: 10px;
  width: 100%;
}

.filter-section label {
  display: block;
  margin-bottom: 8px;
  color: #ff8a8a;
}

/* Simple Pagination Styles */
.pagination-container {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 30px 0;
    gap: 15px;
    padding: 20px;
    background: rgba(26, 26, 26, 0.8);
    border-radius: 12px;
    border: 1px solid #c01a1a;
}

.pagination-btn {
    background-color: #1a1a1a;
    color: white;
    border: 1px solid #c01a1a;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-family: 'Trebuchet MS';
    font-size: 14px;
    transition: all 0.3s ease;
    min-width: 100px;
}

.pagination-btn:hover:not(.disabled) {
    background-color: #2a2a2a;
    border-color: #ff4444;
    transform: translateY(-2px);
}

.pagination-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.page-info {
    color: #ff8a8a;
    font-size: 14px;
    margin: 0 10px;
}

/* Update display container */
#display {
  min-height: 400px;
}
</style>
</head>
<body>

<div id="main-container">
  <!-- Left Panel: Selections and Filters -->
  <div id="selection-panel">
    <div id="header-container">
      <div id="header-top">
        <div id="titles">
          <h1>Gaming Peripheral Finder</h1>
          <h2>Select Your Gaming Brand & Category</h2>
          <h3>Choose a Brand:</h3>
          <ul id="brand-options">
            <li data-brand="Logitech">Logitech</li>
            <li data-brand="Razer">Razer</li>
            <li data-brand="Corsair">Corsair</li>
            <li data-brand="SteelSeries">SteelSeries</li>
          </ul>

          <h3>Choose a Category:</h3>
          <ul id="category-options">
            <li data-category="Mice">Mice</li>
            <li data-category="Keyboards">Keyboards</li>
            <li data-category="Headsets">Headsets</li>
            <li data-category="Chairs">Chairs</li>
          </ul>
          
          <button class="reset-btn" onclick="resetSelections()">Reset Selections</button>
        </div>
        <div id="sort-container">
          <div class="filter-section">
            <label for="sort-select">Sort by Price:</label>
            <select id="sort-select">
              <option value="none">All</option>
              <option value="asc">Lowest to Highest</option>
              <option value="desc">Highest to Lowest</option>
          </select>
          </div>

          <!-- Dropdown for Wired/Wireless filter -->
          <div id="filter-dropdown" style="width: 150px;">
            <div class="filter-section">
              <label for="wireless-filter">Filter by Type:</label>
              <select id="wireless-filter" style="width: 180px;">
                <option value="">All</option>
                <option value="Wired">Wired</option>
                <option value="Wireless">Wireless</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Right Panel: Results -->
  <div id="results-panel">
    <div id="display"></div>
    <!-- Pagination will be inserted here -->
  </div>
</div>

<script>
  // Enhanced Data with more sample items
  const peripherals = [
    // Mice - Logitech
    {
      name: "G304",
      price: "₱2,195.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/products/776c2005-37e3-4cc6-a5b7-051adb1db94f_1.115f433196138a0c65322fd9596d4548.jpg?v=1705570011",
      link: "https://www.logitech.com/en-ph/shop/p/g305-lightspeed-wireless-gaming-mouse.910-005284",
      brand: "Logitech",
      category: "Mice",
      type: "Wired"
    },
    {
      name: "MX Master 4",
      price: "₱2,195.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/products/776c2005-37e3-4cc6-a5b7-051adb1db94f_1.115f433196138a0c65322fd9596d4548.jpg?v=1705570011",
      link: "https://www.logitech.com/en-ph/shop/p/g305-lightspeed-wireless-gaming-mouse.910-005284",
      brand: "Logitech",
      category: "Mice",
      type: "Wired"
    },
    {
      name: "G502 X",
      price: "₱3,895.00",
      image: "https://pi.mdev.kz/7ecc805d-25f6-11ee-a25d-005056b6dbd7?type=webp&w=360&h=360",
      link: "https://www.logitech.com/en-ph/shop/p/g502-x-wired-lightforce.910-006148?sp=2&searchclick=Logitech%20G",
      brand: "Logitech",
      category: "Mice",
      type: "Wired"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    {
      name: "Pro X Superlight",
      price: "₱5,295.00",
      image: "https://ecommerce.datablitz.com.ph/cdn/shop/files/0097855159649_800x.jpg?v=1707806989",
      link: "https://www.logitech.com/en-ph/shop/p/pro-x-superlight-wireless-mouse.910-005944",
      brand: "Logitech",
      category: "Mice",
      type: "Wireless"
    },
    

    // Mice - Razer
    {
      name: "Razer DeathAdder V3",
      price: "$69.99",
      image: "https://assets2.razerzone.com/images/da10m/carousel/razer-deathadder-v3-pro-01.png",
      link: "https://www.razer.com/gaming-mice/razer-deathadder-v3",
      brand: "Razer",
      category: "Mice",
      type: "Wired"
    },
    {
      name: "Razer Viper V2 Pro",
      price: "$149.99",
      image: "https://assets2.razerzone.com/images/viper-v2-pro/carousel/razer-viper-v2-pro-01.png",
      link: "https://www.razer.com/gaming-mice/razer-viper-v2-pro",
      brand: "Razer",
      category: "Mice",
      type: "Wireless"
    },
    
    // Mice - Corsair
    {
      name: "Corsair Dark Core RGB Pro",
      price: "$89.99",
      image: "https://www.corsair.com/us/en/Media/catalog/product/d/a/dark_core_rgb_pro_se_1.png",
      link: "https://www.corsair.com/us/en/p/gaming-mice/CH-9315511-NA/dark-core-rgb-pro-se-wireless-gaming-mouse-ch-9315511-na",
      brand: "Corsair",
      category: "Mice",
      type: "Wireless"
    },
    
    // Keyboards - SteelSeries
    {
      name: "SteelSeries Apex Pro",
      price: "$199.99",
      image: "https://cdn.steelseries.com/static/images/products/apex-pro-tkl-wireless/apex-pro-tkl-wireless-gallery-1.png",
      link: "https://steelseries.com/gaming-keyboards/apex-pro",
      brand: "SteelSeries",
      category: "Keyboards",
      type: "Wired"
    },
    {
      name: "SteelSeries Apex 9",
      price: "$249.99",
      image: "https://cdn.steelseries.com/static/images/products/apex-9/apex-9-gallery-1.png",
      link: "https://steelseries.com/gaming-keyboards/apex-9",
      brand: "SteelSeries",
      category: "Keyboards",
      type: "Wireless"
    },
    
    // Keyboards - Logitech
    {
      name: "Logitech G915",
      price: "$229.99",
      image: "https://resource.logitech.com/w_544,h_466,ar_7:6,c_pad,q_auto,f_auto,dpr_1.0/d_transparent.gif/content/dam/logitech/en/products/keyboards/g915-tkl/gallery/g915-tkl-top-angle-gallery-1.png",
      link: "https://www.logitech.com/en-ph/shop/p/g915-tkl.920-010559",
      brand: "Logitech",
      category: "Keyboards",
      type: "Wireless"
    },
    
    // Headsets - Razer
    {
      name: "Razer BlackShark V2",
      price: "$99.99",
      image: "https://assets2.razerzone.com/images/blackshark-v2-pro/carousel/razer-blackshark-v2-pro-01.png",
      link: "https://www.razer.com/gaming-headsets/razer-blackshark-v2-pro",
      brand: "Razer",
      category: "Headsets",
      type: "Wireless"
    },
    
    // Headsets - Corsair
    {
      name: "Corsair HS80 RGB",
      price: "$149.99",
      image: "https://www.corsair.com/us/en/Media/catalog/product/h/s/hs80_rgb_wireless_gaming_headset_1.png",
      link: "https://www.corsair.com/us/en/p/gaming-headsets/CA-9011282-NA/hs80-rgb-wireless-gaming-headset-ca-9011282-na",
      brand: "Corsair",
      category: "Headsets",
      type: "Wireless"
    },
    
    // Chairs - All brands (no wired/wireless filter)
    {
      name: "Razer Iskur",
      price: "$499.99",
      image: "https://assets2.razerzone.com/images/iskur/carousel/razer-iskur-01.png",
      link: "https://www.razer.com/gaming-chairs/razer-iskur",
      brand: "Razer",
      category: "Chairs",
      type: "Ergonomic"
    },
    {
      name: "Corsair T3 Rush",
      price: "$349.99",
      image: "https://www.corsair.com/us/en/Media/catalog/product/t/3/t3_rush_gaming_chair_1.png",
      link: "https://www.corsair.com/us/en/p/gaming-chairs/CH-9100010-NA/t3-rush-gaming-chair-ch-9100010-na",
      brand: "Corsair",
      category: "Chairs",
      type: "Ergonomic"
    }
  ];

  let selectedBrand = null;
  let selectedCategory = null;
  let currentSortOrder = "none";
  let filterType = null;
  let isCategoryChange = false;
  let currentPage = 1;
  let itemsPerPage = 9;

  const displayDiv = document.getElementById("display");
  const sortContainer = document.getElementById("sort-container");
  const sortSelect = document.getElementById("sort-select");
  const filterDropdownDiv = document.getElementById("filter-dropdown");
  const wirelessFilterSelect = document.getElementById("wireless-filter");

  // Event listeners for brand options
  document.querySelectorAll("#brand-options li").forEach(li => {
    li.addEventListener("click", () => {
      document.querySelectorAll("#brand-options li").forEach(item => {
        item.classList.remove("selected");
      });
      li.classList.add("selected");
      selectedBrand = li.getAttribute("data-brand");
      isCategoryChange = true;
      currentPage = 1; // Reset to first page on new selection
      checkSelectionsAndUpdate();
    });
  });

  // Event listeners for category options
  document.querySelectorAll("#category-options li").forEach(li => {
    li.addEventListener("click", () => {
      document.querySelectorAll("#category-options li").forEach(item => {
        item.classList.remove("selected");
      });
      li.classList.add("selected");
      selectedCategory = li.getAttribute("data-category");
      isCategoryChange = true;
      currentPage = 1; // Reset to first page on new selection
      checkCategoryAndToggleDropdown();
      checkSelectionsAndUpdate();
    });
  });

  // Event listener for sorting
  sortSelect.addEventListener("change", () => {
    currentSortOrder = sortSelect.value;
    isCategoryChange = false;
    updateDisplay();
  });

  // Event listener for wired/wireless dropdown
  wirelessFilterSelect.addEventListener("change", () => {
    const selectedOption = wirelessFilterSelect.value;
    filterType = selectedOption || null;
    isCategoryChange = false;
    currentPage = 1; // Reset to first page on filter change
    updateDisplay();
  });

  function checkSelectionsAndUpdate() {
    if (selectedBrand && selectedCategory) {
      sortContainer.style.display = "flex";
    } else {
      sortContainer.style.display = "none";
    }
    updateDisplay();
  }

  function checkCategoryAndToggleDropdown() {
    if (["Mice", "Keyboards", "Headsets"].includes(selectedCategory)) {
      document.getElementById("filter-dropdown").style.display = "block";
    } else {
      document.getElementById("filter-dropdown").style.display = "none";
      filterType = null;
      wirelessFilterSelect.value = "";
    }
  }

    function updateDisplay() {
    if (isCategoryChange) {
        displayDiv.innerHTML = "<div style='display: flex; justify-content: center; align-items: flex-start; height: 90vh; padding-top: 250px;'><p class='loading' style='text-align: center; font-size: 18px;'>Loading...</p></div>";      
        setTimeout(() => {
            renderDisplayContent();
        }, 300);
    } else {
        renderDisplayContent();
    }
    
    isCategoryChange = false;
}

  function renderDisplayContent() {
    displayDiv.innerHTML = "";

    if (!selectedBrand || !selectedCategory) {
  displayDiv.innerHTML = "<div style='display: flex; justify-content: space-evenly; align-items: center; padding: 100px; padding-top:405px; margin-left: 255px; '><p style='text-align: center; font-size: 20px; color: #ff8a8a;'>Please select a brand and a category.</p></div>";
  return;
}

    // Filter peripherals
    let filtered = peripherals.filter(
      p => p.brand === selectedBrand && p.category === selectedCategory
    );

    // Apply wired/wireless filter
    if (["Mice", "Keyboards", "Headsets"].includes(selectedCategory)) {
      if (filterType) {
        filtered = filtered.filter(p => p.type === filterType);
      }
    }

    if (filtered.length === 0) {
    displayDiv.innerHTML = "<div style='display: flex; justify-content: space-evenly; align-items: center; padding: 100px; padding-top:405px; margin-left: 255px; '><p style='text-align: center; font-size: 18px; color: #ff8a8a;'>No peripherals found for this selection.</p></div>";
    return;
}

    // Apply sorting
    if (currentSortOrder === "asc") {
      filtered.sort((a, b) => {
        const priceA = parseFloat(a.price.replace(/[^\d.]/g, ''));
        const priceB = parseFloat(b.price.replace(/[^\d.]/g, ''));
        return priceA - priceB;
      });
    } else if (currentSortOrder === "desc") {
      filtered.sort((a, b) => {
        const priceA = parseFloat(a.price.replace(/[^\d.]/g, ''));
        const priceB = parseFloat(b.price.replace(/[^\d.]/g, ''));
        return priceB - priceA;
      });
    }

    // Calculate pagination
    const totalItems = filtered.length;
    const totalPages = Math.ceil(totalItems / itemsPerPage);
    
    // Ensure current page is valid
    if (currentPage > totalPages) {
      currentPage = totalPages > 0 ? totalPages : 1;
    }
    
    // Get items for current page
    const startIndex = (currentPage - 1) * itemsPerPage;
    const endIndex = Math.min(startIndex + itemsPerPage, totalItems);
    const itemsToShow = filtered.slice(startIndex, endIndex);

    // Display items for current page
    itemsToShow.forEach(peripheral => {
      const itemDiv = document.createElement("div");
      itemDiv.className = "image-item";

      const link = document.createElement("a");
      link.href = peripheral.link;
      link.target = "_blank";

      const img = document.createElement("img");
      img.src = peripheral.image;
      img.alt = peripheral.name;

      link.appendChild(img);
      itemDiv.appendChild(link);

      const nameDiv = document.createElement("div");
      nameDiv.className = "label";
      nameDiv.textContent = peripheral.name;

      const priceDiv = document.createElement("div");
      priceDiv.className = "label";
      priceDiv.textContent = "Price: " + peripheral.price;

      const typeDiv = document.createElement("div");
      typeDiv.className = "label";
      typeDiv.textContent = peripheral.type;

      itemDiv.appendChild(nameDiv);
      itemDiv.appendChild(priceDiv);
      itemDiv.appendChild(typeDiv);

      displayDiv.appendChild(itemDiv);
    });

    // Create pagination controls if needed
    if (totalPages > 1) {
      createPagination(totalPages, totalItems);
    }
  }

  function createPagination(totalPages, totalItems) {
    // Remove existing pagination
    removePagination();

    const paginationContainer = document.createElement("div");
    paginationContainer.className = "pagination-container";

    // Previous button
    const prevButton = document.createElement("button");
    prevButton.className = "pagination-btn";
    prevButton.textContent = "« Previous";
    prevButton.disabled = currentPage === 1;
    if (prevButton.disabled) prevButton.classList.add("disabled");
    prevButton.addEventListener("click", () => {
      if (currentPage > 1) {
        currentPage--;
        updateDisplay();
      }
    });

    // Next button
    const nextButton = document.createElement("button");
    nextButton.className = "pagination-btn";
    nextButton.textContent = "Next »";
    nextButton.disabled = currentPage === totalPages;
    if (nextButton.disabled) nextButton.classList.add("disabled");
    nextButton.addEventListener("click", () => {
      if (currentPage < totalPages) {
        currentPage++;
        updateDisplay();
      }
    });

    // Page info
    const pageInfo = document.createElement("span");
    pageInfo.className = "page-info";
    pageInfo.textContent = `Page ${currentPage} of ${totalPages} (${totalItems} items total)`;

    // Assemble pagination
    paginationContainer.appendChild(prevButton);
    paginationContainer.appendChild(pageInfo);
    paginationContainer.appendChild(nextButton);

    // Insert pagination after display
    displayDiv.parentNode.insertBefore(paginationContainer, displayDiv.nextSibling);
  }

  function removePagination() {
    const existingPagination = document.querySelector('.pagination-container');
    if (existingPagination) {
      existingPagination.remove();
    }
  }

  function resetSelections() {
    selectedBrand = null;
    selectedCategory = null;
    currentSortOrder = "none";
    filterType = null;
    isCategoryChange = false;
    currentPage = 1;
    itemsPerPage = 9;
    
    document.querySelectorAll("#brand-options li, #category-options li").forEach(li => {
      li.classList.remove("selected");
    });
    
    sortSelect.value = "none";
    wirelessFilterSelect.value = "";
    sortContainer.style.display = "none";
    filterDropdownDiv.style.display = "none";
    
    updateDisplay();
    removePagination();
  }

  // Initialize display
  updateDisplay();
</script>
</body>
</html>